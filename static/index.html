<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: "JetBrains Mono", monospace;
        }
    </style>
    <script>
        let webapp = window.Telegram.WebApp;
        async function verifyInitData() {
            let r = await fetch("/verifyInitData", {
                method: "POST",
                body: JSON.stringify({
                    initData: webapp.initData
                })
            });
            let json = await r.json()
            if (!json["ok"]) {
                document.write("Not allowed");
                webapp.close();
            }
        }
        async function onLoad() {
            await verifyInitData();
        }
    </script>
</head>
<body onload="onLoad()">
    <h1>Hello World!</h1>
    <h2 id="username">@</h2>
    <script>
        let nameH2 = document.getElementById("username");
        nameH2.innerText += webapp.initDataUnsafe.user.username;
    </script>
</body>
</html>